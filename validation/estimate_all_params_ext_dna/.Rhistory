geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_mean_clock_rate.pdf", p)
ggplot(R0_r_all, aes(x=model, y=clock_v)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=model, y=clock_v,fill=model)) + ylab("Clock rate variance") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20))+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_clock_rate_variance.pdf", p)
ggplot(R0_r_all, aes(x=model, y=clock_coefV)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=model, y=clock_coefV,fill=model)) + ylab("Clock rate, coeff. of variation") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20))+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_clock_rate_coeff_var.pdf", p)
p<-ggplot(R0_r_all, aes(x=clock_coefV, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Clock rate coefficient of variation") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1))
p
p<-ggplot(R0_r_all, aes(x=r0_1, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Reproductive number before sampling start") + theme_minimal() +
xlim(c(0.5,1.5)) +theme(legend.justification = c(1, 1), legend.position = c(1, 1))
p
p<-ggplot(R0_r_all, aes(x=model, y=r0_1,fill=model)) + ylab("Reproductive number before sampling start") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20))+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_r0.pdf", p)
ggplot(R0_r_all, aes(x=model, y=r0_1)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=r0_2, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Reproductive number after sampling start") + theme_minimal()+
theme(legend.justification = c(1, 1), legend.position = c(1, 1))
p
p<-ggplot(R0_r_all, aes(x=model, y=r0_2,fill=model)) + ylab("Reproductive number after sampling start") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20))+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_r1.pdf", p)
ggplot(R0_r_all, aes(x=model, y=r0_2)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=b_1, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Become uninfectious before sampling start") + theme_minimal() +
xlim(c(0, 5)) + theme(legend.justification = c(1, 1), legend.position = c(1, 1))
p
p<-ggplot(R0_r_all, aes(x=model, y=b_1,fill=model)) + ylab("Become uninfectious before sampling start") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20))+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_b_1.pdf", p)
ggplot(R0_r_all, aes(x=model, y=b_1)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=b_2, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Become uninfectious after sampling start") + theme_minimal() +
xlim(c(0, 5)) + theme(legend.justification = c(1, 1), legend.position = c(1, 1))
p
p<-ggplot(R0_r_all, aes(x=model, y=b_2,fill=model)) + ylab("Become uninfectious after sampling start") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20))+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_b_2.pdf", p)
ggplot(R0_r_all, aes(x=model, y=b_2)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=s, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Sampling proportion") + theme_minimal() +
theme(legend.justification = c(0, 1), legend.position = c(0, 1))
p
ggplot(R0_r_all, aes(x=model, y=s)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=model, y=s,fill=model)) + ylab("Sampling proportion") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20))+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_s.pdf", p)
p<-ggplot(R0_r_all, aes(x=orig, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Origin") + theme_minimal() +
theme(legend.justification = c(0, 1), legend.position = c(0, 1))
p
ggplot(R0_r_all, aes(x=model, y=orig)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=model, y=orig,fill=model)) + ylab("Origin") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20))+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_orig.pdf", p)
p<-ggplot(R0_r_all, aes(x=model, y=treeHeight,fill=model)) + ylab("Tree Height") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20))+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_treeHeight.pdf", p)
p<-ggplot(R0_r_all, aes(x=model, y=s,fill=model)) + ylab("Sampling proportion") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20), xlim(0,1))+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_s.pdf", p)
p<-ggplot(R0_r_all, aes(x=model, y=s,fill=model)) + ylab("Sampling proportion") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20), ylim(0,1))+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
p<-ggplot(R0_r_all, aes(x=model, y=s,fill=model)) + ylab("Sampling proportion") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20))+ ylim(0,1)+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_s.pdf", p)
SA_relaxed_all <- read.table("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/bulkseq_allserial/no_removal_all_change/relaxed_clock/new_sampling_prior/SA_Georgia_L2_singleSample.log", header=T)
sRange_relaxed_all <- read.table("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/bulkseq_allserial/no_removal_all_change/relaxed_clock/new_sampling_prior/Georgia_L2_allserial.233457685745.log", header=T)
SA_relaxed_all <- tail(SA_relaxed_all, -(round(nrow(SA_relaxed_all)*0.1)))
sRange_relaxed_all <- tail(sRange_relaxed_all, -(round(nrow(sRange_relaxed_all)*0.1)))
sa_r_l <- nrow(SA_relaxed_all)
sR_r_l <- nrow(sRange_relaxed_all)
model <- c(rep("SA", sa_r_l), rep("sRanges", sR_r_l))
R0_r_all <- data.frame(r0_1=c(SA_relaxed_all$R0SVEpi.i0, sRange_relaxed_all$R0.1),
r0_2=c(SA_relaxed_all$R0SVEpi.i1, sRange_relaxed_all$R0.2),
b_1 = c(SA_relaxed_all$becomeUninfectiousRateSVEpi.i0, sRange_relaxed_all$becomeUninfectiousRate.1),
b_2 = c(SA_relaxed_all$becomeUninfectiousRateSVEpi.i1, sRange_relaxed_all$becomeUninfectiousRate.2),
s = c(SA_relaxed_all$samplingProportionSVEpi.i1, sRange_relaxed_all$samplingProportion.2),
orig = c(SA_relaxed_all$originBDMMPrime, sRange_relaxed_all$origin),
treeHeight = c(SA_relaxed_all$TreeHeight, sRange_relaxed_all$TreeHeight),
clock = c(SA_relaxed_all$ORCRatesStat.mean, sRange_relaxed_all$ORCRatesStat.c.Georgia_L2.mean),
clock_v = c(SA_relaxed_all$ORCRatesStat.variance, sRange_relaxed_all$ORCRatesStat.c.Georgia_L2.variance),
clock_coefV = c(SA_relaxed_all$ORCRatesStat.coefficientOfVariation, sRange_relaxed_all$ORCRatesStat.c.Georgia_L2.coefficientOfVariation),
model=model)
p<-ggplot(R0_r_all, aes(x=clock, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Mean clock rate") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1))
p
p<-ggplot(R0_r_all, aes(x=model, y=clock,fill=model)) + ylab("Mean clock rate") + xlab("") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20), axis.text.x=element_text())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_mean_clock_rate.pdf", p)
ggplot(R0_r_all, aes(x=model, y=clock_v)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=model, y=clock_v,fill=model)) + ylab("Clock rate variance") + xlab("") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20), axis.text.x=element_text())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_clock_rate_variance.pdf", p)
ggplot(R0_r_all, aes(x=model, y=clock_coefV)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=model, y=clock_coefV,fill=model)) + ylab("Clock rate, coeff. of variation") + xlab("") +theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20), axis.text.x=element_text())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_clock_rate_coeff_var.pdf", p)
p<-ggplot(R0_r_all, aes(x=clock_coefV, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Clock rate coefficient of variation") + xlab("") +theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1))
p
p<-ggplot(R0_r_all, aes(x=r0_1, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Reproductive number before sampling start") + xlab("") +theme_minimal() +
xlim(c(0.5,1.5)) +theme(legend.justification = c(1, 1), legend.position = c(1, 1))
p
p<-ggplot(R0_r_all, aes(x=model, y=r0_1,fill=model)) + ylab("Reproductive number before sampling start") + xlab("") +theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20), axis.text.x=element_text())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_r0.pdf", p)
ggplot(R0_r_all, aes(x=model, y=r0_1)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=r0_2, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Reproductive number after sampling start") + xlab("") +theme_minimal()+
theme(legend.justification = c(1, 1), legend.position = c(1, 1))
p
p<-ggplot(R0_r_all, aes(x=model, y=r0_2,fill=model)) + ylab("Reproductive number after sampling start") + xlab("") +theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20), axis.text.x=element_text())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_r1.pdf", p)
ggplot(R0_r_all, aes(x=model, y=r0_2)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=b_1, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Become uninfectious before sampling start") + xlab("") + theme_minimal() +
xlim(c(0, 5)) + theme(legend.justification = c(1, 1), legend.position = c(1, 1))
p
p<-ggplot(R0_r_all, aes(x=model, y=b_1,fill=model)) + ylab("Become uninfectious before sampling start") + xlab("") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20), axis.text.x=element_text())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_b_1.pdf", p)
ggplot(R0_r_all, aes(x=model, y=b_1)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=b_2, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Become uninfectious after sampling start") + xlab("") +theme_minimal() +
xlim(c(0, 5)) + theme(legend.justification = c(1, 1), legend.position = c(1, 1))
p
p<-ggplot(R0_r_all, aes(x=model, y=b_2,fill=model)) + ylab("Become uninfectious after sampling start") + xlab("") +theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20), axis.text.x=element_text())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_b_2.pdf", p)
ggplot(R0_r_all, aes(x=model, y=b_2)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=s, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Sampling proportion") + xlab("") +theme_minimal() +
theme(legend.justification = c(0, 1), legend.position = c(0, 1))
p
ggplot(R0_r_all, aes(x=model, y=s)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=model, y=s,fill=model)) + ylab("Sampling proportion") + xlab("") +theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20), axis.text.x=element_text())+ ylim(0,1)+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_s.pdf", p)
p<-ggplot(R0_r_all, aes(x=orig, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Origin") + theme_minimal() +
theme(legend.justification = c(0, 1), legend.position = c(0, 1))
p
ggplot(R0_r_all, aes(x=model, y=orig)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=model, y=orig,fill=model)) + ylab("Origin") + xlab("") +theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20), axis.text.x=element_text())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_orig.pdf", p)
p<-ggplot(R0_r_all, aes(x=model, y=treeHeight,fill=model)) + ylab("Tree Height") +xlab("") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = c(1, 1),text = element_text(size=20), axis.text.x=element_text())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_treeHeight.pdf", p)
p<-ggplot(R0_r_all, aes(x=clock, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Mean clock rate") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = "None")
p
p<-ggplot(R0_r_all, aes(x=model, y=clock,fill=model)) + ylab("Mean clock rate") + xlab("") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = "None",text = element_text(size=20), axis.title.x=element_blank(),         axis.text.x=element_blank(),         axis.ticks.x=element_blank())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_mean_clock_rate.pdf", p)
ggplot(R0_r_all, aes(x=model, y=clock_v)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=model, y=clock_v,fill=model)) + ylab("Clock rate variance") + xlab("") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = "None",text = element_text(size=20), axis.title.x=element_blank(),         axis.text.x=element_blank(),         axis.ticks.x=element_blank())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_clock_rate_variance.pdf", p)
ggplot(R0_r_all, aes(x=model, y=clock_coefV)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=model, y=clock_coefV,fill=model)) + ylab("Clock rate, coeff. of variation") + xlab("") +theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = "None",text = element_text(size=20), axis.title.x=element_blank(),         axis.text.x=element_blank(),         axis.ticks.x=element_blank())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_clock_rate_coeff_var.pdf", p)
p<-ggplot(R0_r_all, aes(x=clock_coefV, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Clock rate coefficient of variation") + xlab("") +theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = "None")
p
p<-ggplot(R0_r_all, aes(x=r0_1, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Reproductive number before sampling start") + xlab("") +theme_minimal() +
xlim(c(0.5,1.5)) +theme(legend.justification = c(1, 1), legend.position = "None")
p
p<-ggplot(R0_r_all, aes(x=model, y=r0_1,fill=model)) + ylab("Reproductive number before sampling start") + xlab("") +theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = "None",text = element_text(size=20), axis.title.x=element_blank(),         axis.text.x=element_blank(),         axis.ticks.x=element_blank())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_r0.pdf", p)
ggplot(R0_r_all, aes(x=model, y=r0_1)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=r0_2, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Reproductive number after sampling start") + xlab("") +theme_minimal()+
theme(legend.justification = c(1, 1), legend.position = "None")
p
p<-ggplot(R0_r_all, aes(x=model, y=r0_2,fill=model)) + ylab("Reproductive number after sampling start") + xlab("") +theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = "None",text = element_text(size=20), axis.title.x=element_blank(),         axis.text.x=element_blank(),         axis.ticks.x=element_blank())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_r1.pdf", p)
ggplot(R0_r_all, aes(x=model, y=r0_2)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=b_1, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Become uninfectious before sampling start") + xlab("") + theme_minimal() +
xlim(c(0, 5)) + theme(legend.justification = c(1, 1), legend.position = "None")
p
p<-ggplot(R0_r_all, aes(x=model, y=b_1,fill=model)) + ylab("Become uninfectious before sampling start") + xlab("") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = "None",text = element_text(size=20), axis.title.x=element_blank(),         axis.text.x=element_blank(),         axis.ticks.x=element_blank())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_b_1.pdf", p)
ggplot(R0_r_all, aes(x=model, y=b_1)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=b_2, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Become uninfectious after sampling start") + xlab("") +theme_minimal() +
xlim(c(0, 5)) + theme(legend.justification = c(1, 1), legend.position = "None")
p
p<-ggplot(R0_r_all, aes(x=model, y=b_2,fill=model)) + ylab("Become uninfectious after sampling start") + xlab("") +theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = "None",text = element_text(size=20), axis.title.x=element_blank(),         axis.text.x=element_blank(),         axis.ticks.x=element_blank())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_b_2.pdf", p)
ggplot(R0_r_all, aes(x=model, y=b_2)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=s, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Sampling proportion") + xlab("") +theme_minimal() +
theme(legend.justification = c(0, 1), legend.position = c(0, 1))
p
ggplot(R0_r_all, aes(x=model, y=s)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=model, y=s,fill=model)) + ylab("Sampling proportion") + xlab("") +theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = "None",text = element_text(size=20), axis.title.x=element_blank(),         axis.text.x=element_blank(),         axis.ticks.x=element_blank())+ ylim(0,1)+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_s.pdf", p)
p<-ggplot(R0_r_all, aes(x=orig, fill=model)) +
geom_density(alpha=0.4, color = NA) + xlab("Origin") + theme_minimal() +
theme(legend.justification = c(0, 1), legend.position = c(0, 1))
p
ggplot(R0_r_all, aes(x=model, y=orig)) +
geom_violin(trim=FALSE)
p<-ggplot(R0_r_all, aes(x=model, y=orig,fill=model)) + ylab("Origin") + xlab("") +theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = "None",text = element_text(size=20), axis.title.x=element_blank(),         axis.text.x=element_blank(),         axis.ticks.x=element_blank())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_orig.pdf", p)
p<-ggplot(R0_r_all, aes(x=model, y=treeHeight,fill=model)) + ylab("Tree Height") +xlab("") + theme_minimal() +
theme(legend.justification = c(1, 1), legend.position = "None",text = element_text(size=20), axis.title.x=element_blank(),         axis.text.x=element_blank(),         axis.ticks.x=element_blank())+
geom_violin(trim=F,alpha=0.4, color="grey",draw_quantiles = c(0.25, 0.5, 0.75))
ggsave("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/figures/all_np_treeHeight.pdf", p)
SA_relaxed_all <- read.table("/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/bulkseq_allserial/no_removal_all_change/relaxed_clock/new_sampling_prior/SA_Georgia_L2_singleSample.log", header=T)
wd <- "/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/bulkseq_allserial/no_removal_all_change/"
# Define the filename
filename <- paste0(wd, "relaxed_clock/new_sampling_prior/Georgia_L2_allserial.233457685745_rates_norm.txt")
# Open the connection to the file
connection <- file(filename, open = "r")
# Read and ignore the first line (header)
readLines(connection, n = 1)
initial_size <- 100000
rates_noRange <- vector("numeric", initial_size)
weight_noRange <- vector("numeric", initial_size)
weight_range <- vector("numeric", initial_size)
rates_range <- vector("numeric", initial_size)
count_nr <- 0
count_r <- 0
# Process each line
while (length(line <- readLines(connection, n = 1)) > 0) {
# Split the line by tabs
columns <- strsplit(line, "\t")[[1]]
# Assuming there are at least three columns in the file
if (length(columns) >= 3) {
col1 <- columns[1]
col2 <- columns[2]
col3 <- columns[3]
if (col3=="1"){
count_r <- count_r + 1
# Resize the vector if needed
if (count_r > length(weight_range)) {
weight_range <- c(weight_range, vector("numeric", initial_size))
rates_range <- c(rates_range, vector("numeric", initial_size))
}
rates_range[count_r] <- as.numeric(col1)
weight_range[count_r] <- as.numeric(col2)
} else {
count_nr <- count_nr + 1
if (count_nr > length(weight_noRange)) {
weight_noRange <- c(weight_noRange, vector("numeric", initial_size))
rates_noRange <- c(rates_noRange, vector("numeric", initial_size))
}
rates_noRange[count_nr] <- as.numeric(col1)
weight_noRange[count_nr] <- as.numeric(col2)
}
}
}
rates_noRange <- rates_noRange[1:count_nr]
weight_noRange <- weight_noRange[1:count_nr]
weight_range <- weight_range[1:count_r]
rates_range <- rates_range[1:count_r]
id_range <- which(rates_range>1e-5)
id_noRange <- which(rates_noRange>1e-5)
wtd.hist(rates_noRange, breaks= 100000,weight=weight_noRange)
wtd.hist(rates_range, breaks= 50000,weight=weight_range)
wtd.hist(rates_noRange[id_noRange], breaks= 1000,weight=weight_noRange[id_noRange], xlim=c(0, 2e-3), density = 30,
col = rgb(1, 0.8, 0.8, 0.5), add=T)
wd <- "/Users/jugne/Documents/Source/beast2.7/sRanges-transmission-material/inference/bulkseq_allserial/no_removal_all_change/"
# Define the filename
filename <- paste0(wd, "relaxed_clock/new_sampling_prior/Georgia_L2_allserial.233457685745_rates_norm.txt")
# Open the connection to the file
connection <- file(filename, open = "r")
# Read and ignore the first line (header)
readLines(connection, n = 1)
initial_size <- 100000
rates_noRange <- vector("numeric", initial_size)
weight_noRange <- vector("numeric", initial_size)
weight_range <- vector("numeric", initial_size)
rates_range <- vector("numeric", initial_size)
count_nr <- 0
count_r <- 0
# Process each line
while (length(line <- readLines(connection, n = 1)) > 0) {
# Split the line by tabs
columns <- strsplit(line, "\t")[[1]]
# Assuming there are at least three columns in the file
if (length(columns) >= 3) {
col1 <- columns[1]
col2 <- columns[2]
col3 <- columns[3]
if (col3=="1"){
count_r <- count_r + 1
# Resize the vector if needed
if (count_r > length(weight_range)) {
weight_range <- c(weight_range, vector("numeric", initial_size))
rates_range <- c(rates_range, vector("numeric", initial_size))
}
rates_range[count_r] <- as.numeric(col1)
weight_range[count_r] <- as.numeric(col2)
} else {
count_nr <- count_nr + 1
if (count_nr > length(weight_noRange)) {
weight_noRange <- c(weight_noRange, vector("numeric", initial_size))
rates_noRange <- c(rates_noRange, vector("numeric", initial_size))
}
rates_noRange[count_nr] <- as.numeric(col1)
weight_noRange[count_nr] <- as.numeric(col2)
}
}
}
rates_noRange <- rates_noRange[1:count_nr]
weight_noRange <- weight_noRange[1:count_nr]
weight_range <- weight_range[1:count_r]
rates_range <- rates_range[1:count_r]
id_range <- which(rates_range>1e-5)
id_noRange <- which(rates_noRange>1e-5)
wtd.hist(rates_noRange, breaks= 100000,weight=weight_noRange)
wtd.hist(rates_range, breaks= 50000,weight=weight_range)
wtd.hist(rates_noRange[id_noRange], breaks= 1000,weight=weight_noRange[id_noRange], xlim=c(0, 2e-3), density = 30,
col = rgb(1, 0.8, 0.8, 0.5), add=T)
wtd.hist(rates_range[id_range], breaks= 1000,weight=weight_range[id_range], xlim=c(0, 2e-3), density = 30,
col = rgb(0.6, 0.8, 1, 0.5))
wtd.hist(rates_noRange[id_noRange], breaks= 1000,weight=weight_noRange[id_noRange], xlim=c(0, 2e-3), density = 30,
col = rgb(1, 0.8, 0.8, 0.5), add=T)
wtd.hist(rates_range, breaks= 50000,weight=weight_range)
id_range <- which(rates_range<1e-5)
id_noRange <- which(rates_noRange<1e-5)
wtd.hist(rates_noRange[id_noRange], breaks= 1000,weight=weight_noRange[id_noRange], xlim=c(0, 1e-5), density = 30,
col = rgb(1, 0.8, 0.8, 0.5))
wtd.hist(rates_range[id_range], breaks= 1000,weight=weight_range[id_range], xlim=c(0, 1e-5), density = 30,
col = rgb(0.6, 0.8, 1, 0.5), add=T)
wtd.hist(rates_range[id_range], breaks= 1000,weight=weight_range[id_range], xlim=c(0, 1e-5), density = 30,
col = rgb(0.6, 0.8, 1, 0.5))
wtd.hist(rates_noRange[id_noRange], breaks= 1000,weight=weight_noRange[id_noRange], xlim=c(0, 1e-5), density = 30,
col = rgb(1, 0.8, 0.8, 0.5), add=T)
wtd.hist(rates_range[id_range], breaks= 1000,weight=weight_range[id_range], xlim=c(0, 1e-5), density = 15,
col = rgb(0.6, 0.8, 1, 0.5))
wtd.hist(rates_noRange[id_noRange], breaks= 1000,weight=weight_noRange[id_noRange], xlim=c(0, 1e-5), density = 15,
col = rgb(1, 0.8, 0.8, 0.5), add=T)
wtd.hist(rates_range[id_range], breaks= 1000,weight=weight_range[id_range], xlim=c(0, 1e-5), density = 15,
col = rgb(0.6, 0.8, 1, 0.5))
wtd.hist(rates_noRange[id_noRange], breaks= 1000,weight=weight_noRange[id_noRange], xlim=c(0, 1e-5), density = 15,
col = rgb(1, 0.8, 0.8, 0.5), add=T)
wtd.hist(rates_range[id_range], breaks= 1000,weight=weight_range[id_range], xlim=c(0, 2e-3), density = 30,
col = rgb(0.6, 0.8, 1, 0.5))
wtd.hist(rates_noRange[id_noRange], breaks= 1000,weight=weight_noRange[id_noRange], xlim=c(0, 2e-3), density = 30,
col = rgb(1, 0.8, 0.8, 0.5), add=T)
id_range <- which(rates_range>1e-5)
id_noRange <- which(rates_noRange>1e-5)
wtd.hist(rates_range[id_range], breaks= 1000,weight=weight_range[id_range], xlim=c(0, 2e-3), density = 30,
col = rgb(0.6, 0.8, 1, 0.5))
wtd.hist(rates_noRange[id_noRange], breaks= 1000,weight=weight_noRange[id_noRange], xlim=c(0, 2e-3), density = 30,
col = rgb(1, 0.8, 0.8, 0.5), add=T)
wtd.hist(rates_range[id_range], breaks= 100,weight=weight_range[id_range], xlim=c(0, 2e-3), density = 30,
col = rgb(0.6, 0.8, 1, 0.5))
wtd.hist(rates_noRange[id_noRange], breaks= 100,weight=weight_noRange[id_noRange], xlim=c(0, 2e-3), density = 30,
col = rgb(1, 0.8, 0.8, 0.5), add=T)
id_range <- which(rates_range<1e-5)
id_noRange <- which(rates_noRange<1e-5)
wtd.hist(rates_range[id_range], breaks= 100,weight=weight_range[id_range], xlim=c(0, 1e-5), density = 15,
col = rgb(0.6, 0.8, 1, 0.5))
wtd.hist(rates_noRange[id_noRange], breaks= 100,weight=weight_noRange[id_noRange], xlim=c(0, 1e-5), density = 15,
col = rgb(1, 0.8, 0.8, 0.5), add=T)
wtd.hist(rates_range[id_range], breaks= 100,weight=weight_range[id_range], xlim=c(0, 1e-5), density = 15,
col = rgb(0.6, 0.8, 1, 0.9))
wtd.hist(rates_noRange[id_noRange], breaks= 100,weight=weight_noRange[id_noRange], xlim=c(0, 1e-5), density = 15,
col = rgb(1, 0.8, 0.8, 0.9), add=T)
wtd.hist(rates_noRange, breaks= 100,weight=weight_noRange)
wtd.hist(rates_range, breaks= 100,weight=weight_range)
length(rates_range[id_range])
id_range <- which(rates_range<1e-5)
id_range <- which(rates_range<1e-5)
length(rates_range[id_range])
id_range <- which(rates_range>1e-5)
length(rates_range[id_range])
wtd.hist(rates_range, breaks= 100,weight=weight_range)
wtd.hist(rates_range[id_range], breaks= 100,weight=weight_range[id_range], xlim=c(0, 2e-3), density = 30,
col = rgb(0.6, 0.8, 1, 0.5))
wtd.hist(rates_range[id_range], breaks= 100,weight=weight_range[id_range], density = 30,
col = rgb(0.6, 0.8, 1, 0.5))
wtd.hist(rates_range[id_range], breaks= 100,weight=weight_range[id_range], density = 30,
col = rgb(0.6, 0.8, 1, 0.5))
wtd.hist(rates_noRange, breaks= 100,weight=weight_noRange, ylim(0,20))
wtd.hist(rates_noRange, breaks=100,weight=weight_noRange, ylim(0,20))
wtd.hist(rates_noRange, breaks=100,weight=weight_noRange, ylim=c(0,20))
wtd.hist(rates_range, breaks= 100,weight=weight_range, ylim=c(0,20))
wtd.hist(rates_range, breaks= 1000,weight=weight_range, ylim=c(0,20))
wtd.hist(rates_noRange, breaks=100,weight=weight_noRange, ylim=c(0,20))
wtd.hist(rates_range, breaks= 100,weight=weight_range, ylim=c(0,20), density = 30,
col = rgb(0.6, 0.8, 1, 0.5))
wtd.hist(rates_range, breaks= 100,weight=weight_range, ylim=c(0,20), density = 30,
col = rgb(0.6, 0.8, 1, 0.9))
wtd.hist(rates_noRange, breaks=100,weight=weight_noRange, ylim=c(0,20), density = 30,
col = rgb(1, 0.8, 0.8, 0.9), add=T)
wtd.hist(rates_range, breaks= 100,weight=weight_range, ylim=c(0,200), density = 30,
col = rgb(0.6, 0.8, 1, 0.9))
wtd.hist(rates_noRange, breaks=100,weight=weight_noRange, ylim=c(0,200), density = 30,
col = rgb(1, 0.8, 0.8, 0.9), add=T)
wtd.hist(rates_range, breaks= 100,weight=weight_range, density = 30,
col = rgb(0.6, 0.8, 1, 0.9))
wtd.hist(rates_noRange, breaks=100,weight=weight_noRange, density = 30,
col = rgb(1, 0.8, 0.8, 0.9), add=T)
wtd.hist(rates_range, breaks= 100,weight=weight_range, ylim=c(0,200), density = 30,
col = rgb(0.6, 0.8, 1, 0.9))
wtd.hist(rates_noRange, breaks=100,weight=weight_noRange, ylim=c(0,200), density = 30,
col = rgb(1, 0.8, 0.8, 0.9), add=T)
wtd.hist(rates_range, breaks= 100,weight=weight_range, ylim=c(0,50), density = 30,
col = rgb(0.6, 0.8, 1, 0.9))
wtd.hist(rates_noRange, breaks=100,weight=weight_noRange, ylim=c(0,50), density = 30,
col = rgb(1, 0.8, 0.8, 0.9), add=T)
wtd.hist(rates_range, breaks= 100,weight=weight_range, ylim=c(0,45), density = 30,
col = rgb(0.6, 0.8, 1, 0.9))
wtd.hist(rates_noRange, breaks=100,weight=weight_noRange, ylim=c(0,45), density = 30,
col = rgb(1, 0.8, 0.8, 0.9), add=T)
wtd.hist(rates_range, breaks= 100,weight=weight_range, density = 30,
col = rgb(0.6, 0.8, 1, 0.9))
wtd.hist(rates_noRange, breaks=100,weight=weight_noRange, density = 30,
col = rgb(1, 0.8, 0.8, 0.9), add=T)
wtd.hist(rates_range, breaks= 100,weight=weight_range, ylim=c(0,200), density = 30,
col = rgb(0.6, 0.8, 1, 0.9))
wtd.hist(rates_noRange, breaks=100,weight=weight_noRange, ylim=c(0,200), density = 30,
col = rgb(1, 0.8, 0.8, 0.9), add=T)
wtd.hist(rates_range, breaks= 100,weight=weight_range, ylim=c(0,45), density = 30,
col = rgb(0.6, 0.8, 1, 0.9))
wtd.hist(rates_noRange, breaks=100,weight=weight_noRange, ylim=c(0,45), density = 30,
col = rgb(1, 0.8, 0.8, 0.9), add=T)
wtd.hist(rates_range, breaks= 100,weight=weight_range, xlim=c(0, 1e-6), density = 30,
col = rgb(0.6, 0.8, 1, 0.9))
wtd.hist(rates_range, breaks= 100,weight=weight_range, xlim=c(0, 1e-6), density = 30,
col = rgb(0.6, 0.8, 1, 0.9))
wtd.hist(rates_noRange, breaks=100,weight=weight_noRange, xlim=c(0, 1e-6), density = 30,
col = rgb(1, 0.8, 0.8, 0.9), add=T)
wtd.hist(rates_range, breaks=100,weight=weight_range, xlim=c(0, 1e-8), density = 30,
col = rgb(0.6, 0.8, 1, 0.9))
wtd.hist(rates_range, breaks=1000,weight=weight_range, xlim=c(0, 1e-8), density = 30,
col = rgb(0.6, 0.8, 1, 0.9))
wtd.hist(rates_range, breaks=1000,weight=weight_range, xlim=c(0, 1e-8), density = 30,
col = rgb(0.6, 0.8, 1, 0.9))
